{"version":3,"file":"index.js","sources":["../src/enmu/index.ts","../src/index.ts"],"sourcesContent":["\r\nexport enum Dictionary {\r\n    expire = '_expire_',\r\n    permanent = 'permanent'\r\n}\r\n\r\n","import { Key,StorageCls,expire,Data,Result } from \"./type\";\r\nimport { Dictionary } from \"./enmu\";\r\nexport class Storage implements StorageCls {\r\n    get <T> (key:Key):Result<T>{\r\n        const value = localStorage.getItem(key)\r\n        const data:Data<T> = JSON.parse(value)\r\n        if(value){\r\n            // 存了key，拿取key\r\n            const now = new Date().getTime()\r\n            if(typeof data[Dictionary.expire] === 'number' && data[Dictionary.expire] < now) {\r\n                // 已过期\r\n                // 删除key\r\n                this.remove(key)\r\n                return {\r\n                    message:`${key}已过期`,\r\n                    value:null\r\n                }\r\n            } else {\r\n                \r\n                // 未过期\r\n                return {\r\n                    message:'读取成功',\r\n                    value:data.value\r\n                }\r\n            }\r\n        } else {\r\n            // 未存key\r\n            console.warn('key值无效');\r\n            return {\r\n                message:`${key}无效`,\r\n                value:null\r\n            }\r\n        }\r\n    }\r\n    set<T>(key:Key,value:T,expire:expire = Dictionary.permanent){\r\n        const data = JSON.stringify({\r\n            value,\r\n            [Dictionary.expire]:expire\r\n        })\r\n        localStorage.setItem(key,data)\r\n    }\r\n    remove(key:Key){\r\n        if(localStorage.getItem(key)){\r\n            localStorage.removeItem(key)\r\n        }\r\n    }  \r\n    clear(){\r\n        localStorage.clear()\r\n    }\r\n}\r\n\r\n"],"names":["Dictionary","Storage","get","key","value","localStorage","getItem","data","JSON","parse","now","Date","getTime","expire","this","remove","message","console","warn","set","permanent","stringify","setItem","removeItem","clear"],"mappings":"AACA,IAAYA,GAAZ,SAAYA,GACRA,EAAA,OAAA,WACAA,EAAA,UAAA,WACH,CAHD,CAAYA,IAAAA,EAGX,CAAA,UCFYC,EACTC,IAASC,GACL,MAAMC,EAAQC,aAAaC,QAAQH,GAC7BI,EAAeC,KAAKC,MAAML,GAChC,GAAGA,EAAM,CAEL,MAAMM,GAAM,IAAIC,MAAOC,UACvB,MAAsC,iBAA5BL,EAAKP,EAAWa,SAAwBN,EAAKP,EAAWa,QAAUH,GAGxEI,KAAKC,OAAOZ,GACL,CACHa,QAAQ,GAAGb,OACXC,MAAM,OAKH,CACHY,QAAQ,OACRZ,MAAMG,EAAKH,MAGtB,CAGG,OADAa,QAAQC,KAAK,UACN,CACHF,QAAQ,GAAGb,MACXC,MAAM,KAGjB,CACDe,IAAOhB,EAAQC,EAAQS,EAAgBb,EAAWoB,WAC9C,MAAMb,EAAOC,KAAKa,UAAU,CACxBjB,QACA,CAACJ,EAAWa,QAAQA,IAExBR,aAAaiB,QAAQnB,EAAII,EAC5B,CACDQ,OAAOZ,GACAE,aAAaC,QAAQH,IACpBE,aAAakB,WAAWpB,EAE/B,CACDqB,QACInB,aAAamB,OAChB"}