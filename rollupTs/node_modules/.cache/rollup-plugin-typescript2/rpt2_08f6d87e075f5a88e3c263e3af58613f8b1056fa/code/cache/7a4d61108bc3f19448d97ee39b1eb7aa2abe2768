{"code":"// 消息订阅与发布\r\nclass Dispatch {\r\n    constructor() {\r\n        this.list = {};\r\n    }\r\n    on(name, cb) {\r\n        const eventLi = this.list[name] || [];\r\n        eventLi.push(cb);\r\n        this.list[name] = eventLi;\r\n    }\r\n    emit(name, ...arg) {\r\n        const eventLi = this.list[name];\r\n        if (eventLi) {\r\n            eventLi.forEach(fn => {\r\n                fn.apply(this, arg);\r\n            });\r\n        }\r\n        else {\r\n            console.error(`${name}未知事件`);\r\n        }\r\n    }\r\n    // 删除事件\r\n    off(name, fn) {\r\n        const eventLi = this.list[name];\r\n        let ind;\r\n        if (eventLi && fn) {\r\n            eventLi.forEach((fni, index) => {\r\n                if (fni === fn) {\r\n                    ind = index;\r\n                }\r\n            });\r\n            eventLi.splice(ind, 1);\r\n        }\r\n        else {\r\n            console.error(`${name}未知事件`);\r\n        }\r\n        this.list[name] = eventLi;\r\n    }\r\n    // 只执行一次\r\n    once(name, fn) {\r\n        const fns = (...arg) => {\r\n            fn.apply(this, arg);\r\n            this.off(name, fns);\r\n        };\r\n        this.on(name, fns);\r\n    }\r\n}\r\n// PubSub类比\r\n// PubSub.subscribe('订阅消息名',(a, 传递来的参数 )=>{\r\n//回调\r\n//})\r\n/**\r\n * PubSub.publish('订阅消息名', ...携带参数 )\r\n *\r\n *\r\n *\r\n */\r\nconst test = new Dispatch();\r\ntest.on('post', (...arg) => {\r\n    console.log(arg, 1);\r\n});\r\nconst fn = (...arg) => {\r\n    console.log(arg, 2);\r\n};\r\ntest.on('post', fn);\r\ntest.off('post', fn);\r\ntest.once('post', (...arg) => {\r\n    console.log(arg, 3);\r\n});\r\ntest.emit('post', 1, false, '111');\r\ntest.emit('post', 1, false, '111');\r\n//# sourceMappingURL=index.js.map","references":[],"map":"{\"version\":3,\"file\":\"index.js\",\"sourceRoot\":\"\",\"sources\":[\"../../../../src/index.ts\"],\"names\":[],\"mappings\":\"AAAA,UAAU;AAcV,MAAM,QAAQ;IAEV;QACI,IAAI,CAAC,IAAI,GAAG,EAAE,CAAA;IAClB,CAAC;IACD,EAAE,CAAC,IAAW,EAAC,EAAW;QACtB,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAA;QACrC,OAAO,CAAC,IAAI,CAAC,EAAE,CAAC,CAAA;QAChB,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,OAAO,CAAA;IAC7B,CAAC;IACD,IAAI,CAAC,IAAW,EAAC,GAAG,GAAc;QAC9B,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;QAC/B,IAAG,OAAO,EAAC;YACP,OAAO,CAAC,OAAO,CAAC,EAAE,CAAA,EAAE;gBAChB,EAAE,CAAC,KAAK,CAAC,IAAI,EAAC,GAAG,CAAC,CAAA;YACtB,CAAC,CAAC,CAAA;SACL;aAAM;YACH,OAAO,CAAC,KAAK,CAAC,GAAG,IAAI,MAAM,CAAC,CAAA;SAC/B;IACL,CAAC;IACD,OAAO;IACP,GAAG,CAAC,IAAW,EAAC,EAAW;QACvB,MAAM,OAAO,GAAG,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,CAAA;QAC/B,IAAI,GAAG,CAAC;QACR,IAAG,OAAO,IAAI,EAAE,EAAC;YACb,OAAO,CAAC,OAAO,CAAC,CAAC,GAAG,EAAC,KAAK,EAAC,EAAE;gBACzB,IAAG,GAAG,KAAK,EAAE,EAAC;oBACV,GAAG,GAAG,KAAK,CAAA;iBACd;YACL,CAAC,CAAC,CAAA;YACF,OAAO,CAAC,MAAM,CAAC,GAAG,EAAC,CAAC,CAAC,CAAC;SACzB;aAAM;YACH,OAAO,CAAC,KAAK,CAAC,GAAG,IAAI,MAAM,CAAC,CAAC;SAChC;QACD,IAAI,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,OAAO,CAAA;IAC7B,CAAC;IACD,QAAQ;IACR,IAAI,CAAC,IAAW,EAAC,EAAW;QACxB,MAAM,GAAG,GAAG,CAAC,GAAG,GAAc,EAAE,EAAE;YAC9B,EAAE,CAAC,KAAK,CAAC,IAAI,EAAC,GAAG,CAAC,CAAA;YAClB,IAAI,CAAC,GAAG,CAAC,IAAI,EAAC,GAAG,CAAC,CAAA;QACtB,CAAC,CAAA;QACD,IAAI,CAAC,EAAE,CAAC,IAAI,EAAC,GAAG,CAAC,CAAA;IACrB,CAAC;CACJ;AAED,WAAW;AAEX,2CAA2C;AACvC,IAAI;AACR,IAAI;AAGJ;;;;;GAKG;AAGH,MAAM,IAAI,GAAG,IAAI,QAAQ,EAAE,CAAA;AAE3B,IAAI,CAAC,EAAE,CAAC,MAAM,EAAC,CAAC,GAAG,GAAc,EAAC,EAAE;IAChC,OAAO,CAAC,GAAG,CAAC,GAAG,EAAC,CAAC,CAAC,CAAC;AACvB,CAAC,CAAC,CAAA;AACF,MAAM,EAAE,GAAG,CAAC,GAAG,GAAc,EAAC,EAAE;IAC5B,OAAO,CAAC,GAAG,CAAC,GAAG,EAAC,CAAC,CAAC,CAAC;AAEvB,CAAC,CAAA;AAED,IAAI,CAAC,EAAE,CAAC,MAAM,EAAC,EAAE,CAAC,CAAA;AAElB,IAAI,CAAC,GAAG,CAAC,MAAM,EAAC,EAAE,CAAC,CAAA;AAEnB,IAAI,CAAC,IAAI,CAAC,MAAM,EAAC,CAAC,GAAG,GAAc,EAAC,EAAE;IAClC,OAAO,CAAC,GAAG,CAAC,GAAG,EAAC,CAAC,CAAC,CAAC;AACvB,CAAC,CAAC,CAAA;AAEF,IAAI,CAAC,IAAI,CAAC,MAAM,EAAC,CAAC,EAAC,KAAK,EAAC,KAAK,CAAC,CAAA;AAC/B,IAAI,CAAC,IAAI,CAAC,MAAM,EAAC,CAAC,EAAC,KAAK,EAAC,KAAK,CAAC,CAAA\"}"}
